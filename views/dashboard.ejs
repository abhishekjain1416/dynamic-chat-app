<%- include('layouts/header.ejs') %>

<h2 class="mb-4">Hii, <%= user.name %></h2>

<div class="row">
    <div class="col-md-4">
        <ul class="list-group">
            <%
                if(users.length > 0){
                    for(let i=0; i < users.length; i++){
                        %>
                        <li class="list-group-item list-group-item-dark cursor-pointer user-list" data-id="<%= users[i]['_id'] %>">
                            <img src="<%= users[i]['image'] %>" alt="" width="100px" height="100px">
                            <%= users[i]['name'] %>
                        </li>
                        <%
                        if(users[i]['is_online'] == 1){
                            %>
                            <sup class="online-status" id="<%= users[i]['_id'] %>-status">Online</sup>
                            <%
                        } else {
                            %>
                            <sup class="offline-status" id="<%= users[i]['_id'] %>-status">Offline</sup>
                            <%
                        }
                    }
                }
            %>
        </ul>
    </div>

    <div class="col-md-8">

        <h3 class="start-head"> Click to Start the Chat </h3>
        <div class="chat-section">

            <div id="chat-container">
                <div class="current-user-chat">
                </div>
                <div class="distance-user-chat">
                </div>
            </div>

            <form action="" id="chat-form">
                <input type="text" name="message" placeholder="Enter Message" id="message" class="border" required>
                <input type="submit" value="Send Message" class="btn btn-primary">
            </form>

        </div>

    </div>
</div>

<div class="modal fade" id="deleteChatModal" tabindex="-1" role="dialog" aria-labelledby="deleteChatModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="deleteChatModalLongTitle">Delete Chat</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
            </button>
        </div>

        <form id="delete-chat-form">
            <div class="modal-body">
                <input type="hidden" name="id" id="delete-message-id">
                <p>Are you sure you want to delete the below message?</p>
                <p><b id="delete-message"></b></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="submit" class="btn btn-danger">Delete</button>
            </div>
        </form>
        </div>
    </div>
</div>

<div class="modal fade" id="editChatModal" tabindex="-1" role="dialog" aria-labelledby="editChatModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="editChatModalLongTitle">Edit Chat</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
            </button>
        </div>

        <form id="update-chat-form">
            <div class="modal-body">
                <input type="hidden" name="id" id="edit-message-id">
                <input type="text" name="message" id="edit-message" placeholder="Enter Message" required>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="submit" class="btn btn-danger">Save</button>
            </div>
        </form>
        </div>
    </div>
</div>

<%- include('layouts/footer.ejs') %>